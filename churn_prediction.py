# -*- coding: utf-8 -*-
"""Churn_Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/17jLh4eCy0K2fvF16MXStIfw3ln5Lb3IJ
"""

import streamlit as st
import joblib
import numpy as np
import pandas as pd

model = joblib.load('XGBoostModel.pkl')
gender_encode = joblib.load('genderEncode.pkl')

def main():
  st.title('Churn Model Deployment')

  age = st.number_input('Age', 0, 100)
  gender = st.radio('Gender', ['Male', 'Female'])
  geography = st.selectbox('Select a country', ['France','Germany','Spain'])
  tenure = st.number_input('Period of time in a position (years)', 0, 100)
  creditScore = st.number_input('Credit Score', 0, 1000)
  balance = st.number_input('Total balance', 0, 500000)
  numProduct = st.number_input('Number of products', 0, 10)
  creditCard = st.checkbox('Do you have a credit card?')
  activeMember = st.checkbox('Are you an active member?')
  salary = st.number_input('Estimated salary', 0, 500000)

  data = {'Age': int(age), 'Gender': gender, 'Geography': geography, 'Tenure': int(tenure),
          'CreditScore': float(creditScore), 'Balance': float(balance), 'NumOfProducts': int(numProduct),
          'HasCrCard': int(creditCard), 'IsActiveMember': int(activeMember), 'EstimatedSalary': float(salary)}

  df = pd.DataFrame([list(data.values())], columns = ['Age','Gender','Geography','Tenure','CreditScore',
                                                      'Balance','NumOfProducts','HasCrCard','IsActiveMember',
                                                      'EstimatedSalary'])

  df = df.replace(gender_encode)
  df = pd.get_dummies(df, columns = ['Geography'], dtype = int)

  if st.button('Make Prediction'):
    features = df
    result = make_prediction(features)
    st.success(f'The prediction is: {result}')

def make_prediction(features):
  input = np.array(features).reshape(1, -1)
  prediction = model.predict(input)
  return prediction[0]

if __name__ == '__main__':
  main()